(function () {
    "use strict";

    var ControlConstructor = WinJS.UI.Pages.define("/movies/home", {
        init : function (element, options) {
            function callback(responseText, status) {
                if (status === 200) {
                    var items = JSON.parse(responseText);
                    
                    WinJS.Namespace.define("App.home", {
                        data: new WinJS.Binding.List(items)
                    });
                } else {
                    output("Error obtaining feed. XHR status code: " + status);
                }
                
                WinJS.UI.processAll();
            }

            function output(s) {
                document.getElementById("content").innerHTML += s;
            }

            return WinJS.xhr({ url: '/movies/' + options.categorie + '.json', type: 'GET' }).then(
                function (result) {
                    callback(result.responseText, result.status);
                },
                function (result) {
                    callback(null, result.status);
                }
            );

        }
    });
})();